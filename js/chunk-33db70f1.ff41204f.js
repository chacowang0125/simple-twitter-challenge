(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33db70f1"],{5263:function(e,t,a){e.exports=a.p+"img/active-like-icon.b9abe96b.svg"},5543:function(e,t,a){},8906:function(e,t,a){},"9ec8":function(e,t,a){"use strict";a("8906")},b2d0:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Spinner",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"container"},[0===this.tweets.length?a("div",{staticClass:"empty-message"},[e._v(" 使用者沒有任何推文 (ノ▼Д▼)ノ ")]):e._e(),a("div",{staticClass:"user-tweet-container"},e._l(e.tweets,(function(t){return a("UserTweetFeed",{key:t.id,attrs:{"initial-tweet":t},on:{"after-reply-modal-click":e.afterReplyModalClick}})})),1),a("div",{staticClass:"modal"},[a("ReplyPostModal",{attrs:{tweet:e.modaltweet},on:{"after-submit":e.afterReplySubmit}})],1)])],1)},n=[],r=a("5530"),i=a("1da1"),c=(a("96cf"),a("2708")),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"tweet-card"},[s("router-link",{staticClass:"tweet-card-img",attrs:{to:{name:"tweet",params:{id:e.tweet.User.id}}}},[s("img",{staticClass:"tweet-card-img",attrs:{src:e._f("emptyImage")(e.tweet.User.avatar)}})]),s("div",{staticClass:"tweet-card-content"},[s("div",{staticClass:"tweet-card-content-info"},[s("span",{staticClass:"name"},[e._v(e._s(e._f("nameLength")(e.tweet.User.name)))]),s("span",{staticClass:"account"},[e._v("@"+e._s(e.tweet.User.account))]),s("span",{staticClass:"created-at"},[e._v(e._s(e._f("fromNow")(e.tweet.createdAt)))]),s("router-link",{attrs:{to:{name:"tweets-detail",params:{id:e.tweet.id}}}},[s("div",{staticClass:"tweet-card-content-text"},[e._v(" "+e._s(e.tweet.description)+" ")])]),s("div",{staticClass:"tweet-card-content-reply",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.replyModalClick(e.tweet.id)}}},[s("div",{staticClass:"content-reply"},[s("img",{staticClass:"content-reply-icon",attrs:{src:a("1eba")}}),s("span",{staticClass:"content-reply-number"},[e._v(e._s(e.tweet.commentCounts))])]),s("div",{staticClass:"content-reply",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.likeToggle(e.tweet.id)}}},[1!==e.tweet.isLiked?s("img",{staticClass:"content-reply-icon",attrs:{src:a("a083")}}):s("img",{staticClass:"content-reply-icon",attrs:{src:a("5263")}}),s("span",{staticClass:"content-reply-number",class:{active:1===e.tweet.isLiked},attrs:{disabled:e.isProcessing}},[e._v(e._s(e.tweet.likeCounts)+" ")])])])],1)])],1)},l=[],d=a("7482"),u=a("2fa3"),w={mixins:[c["c"],c["b"],c["d"]],name:"UserTweetFeed",props:{initialTweet:{type:Object,required:!0}},data:function(){return{tweet:this.initialTweet,isProcessing:!1}},methods:{likeToggle:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s,n,i,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,t.isProcessing=!0,s=!t.tweet.isLiked,n={},!s){a.next=10;break}return a.next=7,d["a"].addLike({tweetId:e});case 7:n=a.sent,a.next=13;break;case 10:return a.next=12,d["a"].deleteLike({tweetId:e});case 12:n=a.sent;case 13:if(i=n,c=i.data,"success"===c.status){a.next=16;break}throw new Error(c.message);case 16:s=s?1:0,t.tweet=Object(r["a"])(Object(r["a"])({},t.tweet),{},{isLiked:s}),t.tweet=1===s?Object(r["a"])(Object(r["a"])({},t.tweet),{},{likeCounts:t.tweet.likeCounts+1}):Object(r["a"])(Object(r["a"])({},t.tweet),{},{likeCounts:t.tweet.likeCounts-1}),t.isProcessing=!1,a.next=26;break;case 22:a.prev=22,a.t0=a["catch"](0),t.isProcessing=!1,u["a"].fire({icon:"warning",title:a.t0.message});case 26:case"end":return a.stop()}}),a,null,[[0,22]])})))()},replyModalClick:function(e){this.$emit("after-reply-modal-click",e),console.log(e)}},watch:{initialTweet:function(e){this.tweet=Object(r["a"])(Object(r["a"])({},this.tweet),e)}}},p=w,m=(a("e1d7"),a("2877")),f=Object(m["a"])(p,o,l,!1,null,"11af22ca",null),g=f.exports,v=a("4cce"),h=a("2375"),b=a("2f62"),k=a("cf6a"),C={mixins:[c["c"]],name:"UserTweetView",components:{UserTweetFeed:g,Spinner:h["a"],ReplyPostModal:k["a"]},data:function(){return{tweets:[],isLoading:!0,modaltweet:{}}},created:function(){var e=this.$route.params.id;this.fetchTweets(e)},beforeRouteUpdate:function(e,t,a){var s=e.params.id;this.fetchTweets(s),a()},methods:{fetchTweets:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v["a"].getTotalTweets({userId:e});case 3:s=a.sent,n=s.data,t.tweets=n,t.isLoading=!1,a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](0),r=a.t0.response.data,u["a"].fire({icon:"warning",title:r.message});case 13:case"end":return a.stop()}}),a,null,[[0,9]])})))()},afterReplyModalClick:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t.$store.commit("toggleReplyPostModal"),a.next=4,d["a"].getTweet({tweetId:e});case 4:s=a.sent,n=s.data,t.modaltweet=n,console.log(n),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](0),u["a"].fire({icon:"warning",title:"無法取得推文資料，請稍後再試"});case 13:case"end":return a.stop()}}),a,null,[[0,10]])})))()},afterReplySubmit:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var n,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,d["a"].addTweetReply({tweetId:e,comment:t});case 3:if(n=s.sent,r=n.data,"success"===r.status){s.next=7;break}throw new Error(r.message);case 7:u["a"].fire({icon:"success",title:"回覆推文成功"}),a.$store.commit("toggleReplyPostModal"),a.$store.commit("toggleReplyCreated"),s.next=15;break;case 12:s.prev=12,s.t0=s["catch"](0),u["a"].fire({icon:"warning",title:"無法回覆留言，請稍後再試"});case 15:case"end":return s.stop()}}),s,null,[[0,12]])})))()}},computed:Object(r["a"])({},Object(b["c"])(["getTweetCreated","getReplyCreated"])),watch:{getTweetCreated:{deep:!0,handler:function(){var e=this.$route.params.id;this.fetchTweets(e)}},getReplyCreated:{deep:!0,handler:function(){var e=this.$route.params.id;this.fetchTweets(e)}}}},y=C,x=(a("9ec8"),Object(m["a"])(y,s,n,!1,null,"2d57dc19",null));t["default"]=x.exports},e1d7:function(e,t,a){"use strict";a("5543")}}]);
//# sourceMappingURL=chunk-33db70f1.ff41204f.js.map